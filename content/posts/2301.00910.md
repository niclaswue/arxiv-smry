---
title: "Causal Inference in Recommender Systems: A Survey of Strategies for Bias Mitigation, Explanation, and Generalization"
date: 2023-01-03T00:56:50.000Z
author: "Yaochen Zhu, Jing Ma, Jundong Li"
weight: 2
showToc: true
TocOpen: true
draft: false
hidemeta: false
comments: false
description: "Important disclaimer: the following content is AI-generated, please make sure to fact check the presented information by reading the full paper."
disableHLJS: true # to disable highlightjs
disableShare: false
hideSummary: false
searchHidden: false
ShowReadingTime: false
ShowBreadCrumbs: false
ShowPostNavLinks: false
ShowWordCount: true
ShowRssButtonInSectionTermList: false
UseHugoToc: false
cover:
    image: "https://ik.imagekit.io/smryai/2301-00910v1_jwP_r32K1.jpg" # image path/url
    alt: "Causal Inference in Recommender Systems: A Survey of Strategies for Bias Mitigation, Explanation, and Generalization" # alt text
    caption: "The full paper is available [here](https://arxiv.org/abs/2301.00910)." # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: false # only hide on current single page
---

# Link to paper
The full paper is available [here](https://arxiv.org/abs/2301.00910).


# Abstract
- Traditional RSs estimate user interests and predict their future behaviors by utilizing correlations in the observational historical activities, their profiles, and the content of interacted items.
- However, since the inherent causal reasons that lead to the observed users' behaviors are not considered, multiple types of biases could exist in the generated recommendations.
- In addition, the causal motives that drive user activities are usually entangled in these RSs, where the explainability and generalization abilities of recommendations cannot be guaranteed.
- To address these drawbacks, recent years have witnessed an upsurge of interest in enhancing traditional RSs with causal inference techniques.
- In this survey, we provide a systematic overview of causal RSs and help readers gain a comprehensive understanding of this promising area.
- We start with the basic concepts of traditional RSs and their limitations due to the lack of causal reasoning ability.
- We then discuss how different causal inference techniques can be introduced to address these challenges, with an emphasis on debiasing, explainability promotion, and generalization improvement.
- Furthermore, we thoroughly analyze various evaluation strategies for causal RSs, focusing especially on how to reliably estimate their performance with biased data if the causal effects of interests are unavailable.
- Finally, we provide insights into potential directions for future causal RS research.

# Paper Content

## Introduction
- RSs are able to predict future behaviors and recommend items to users
- Traditional RSs can be divided into three classes: collaborative filtering-based, content-based, and hybrid
- Collaborative filtering-based RSs estimate user interests and predict their future behaviors by exploiting their past activities, such as browsing, clicking, purchases, etc.
- Content-based methods, on the other hand, predict new recommendations by matching user interests with item content.
- Hybrid methods combine the advantages of both worlds, where collaborative information and user/item feature information are comprehensively considered to generate more accurate recommendations.
- However, traditional RSs are limited in that they can only estimate user interests and predict future recommendations based on correlations in the observational user historical behaviors and user/item features
- Causal questions about user behaviors and their effects on past restaurant visits are important for RSs because they allow for the enhancement of the RS algorithm based on users' personalized preferences

## Recommender System Basics
- RSs are data-driven models that use ratings to predict user ratings for previously uninteracted items.
- The rating for an item is represented by a user-item rating matrix R, where a non-zero element    denotes user's rating to item, and a zero element  0  indicates the rating is missing.
- To make the discussions of RSs compatible with causal inference, we take a probabilistic view of R, where    is assumed to be the realized value of the We use rating to refer to any user-item interaction that can be represented by a numerical value.
- This includes both explicit feedback such as likes/dislikes, and implicit feedback such as views and clicks.
- When    represents implicit feedback, the missing elements  0  in R may be used as weak negative feedback in the training phase [16].

### Collaborative Filtering
- Collaborative filtering-based RSs recommend new items by leveraging past ratings.
- They generally consider the ratings as being generated from a user latent variable u that represents user interests and an item latent variable v that encodes the item attributes (i.e., item latent semantic information), where is the dimension of the latent space.
- There are three widely-used collaborative filtering-based RSs: Matrix Factorization (MF), Deep Matrix Factorization (DMF), and Auto-encoder (AE)-based RSs.
- In the training phase, the models learn the latent variables u, v, and the associated function  by fitting on the observed ratings.
- Afterward, we can use them to predict new ratings for previously uninteracted items.

### Content-Based Recommender Systems
- Personalized content-based RSs (CBRSs) estimate user interests based on the features of the items they have interacted with.
- These models typically encode user interests into user latent variables u  ∈ R  and assume that the ratings are generated by matching user interests with item content, i.e.,    ∼ N (  (u  , f  ),    ), where  is a matching function.
- The training of personalized CBRSs follow similar steps as collaborative filtering, where u  and  are learned by fitting on the observed ratings (which essentially estimates the conditional distribution (   |u  , f  ) from the observational data), and new ratings can be predicted by r =  (u  , f  ).
- The key step of building a CBRS is to create item features f  that can best reflect user interests, which crucially depends on the item being recommended.

### Hybrid Recommendation
- Hybrid RSs combine user/item side information with collaborative filtering to improve the recommendations.
- A commonly-used hybrid strategy is to augment user and item latent variables with user/item side information.
- Dimensions of user/item side information that encode the collaborative information are adjusted accordingly.
- Another important class of hybrid RS is the factorization machine (FM) and its extensions like [31,32], which can be viewed as learning a bi-linear function where the ratings are generated by Simple hybrid strategies cannot break the correlational reasoning limitation of collaborative filtering and content-based RSs.

## Causal Recommender Systems: Preliminaries
- The traditional RSs (RS1, RS2, RS3) have limitations due to correlational reasoning on observational user behaviors
- Two causal inference frameworks, i.e., Rubin's potential outcome framework (also known as the Rubin causal model, RCM) [33] and Pearl's structural causal model (SCM) [34], are introduced in the context of RSs
- Both RCM and SCM are powerful frameworks to build RSs with causal reasoning ability, but they are best suited for different tasks and questions

### Rubin's Potential Outcome Framework
- Traditional RSs are susceptible to the confounding bias where the causal path  →  is confounded by   .
- RCM-based RSs are immune to the confounding bias because the causal path  →  is not confounded by   .

### Pearl's Structural Causal Model

## Causal Recommender Systems: The State-of-the-Art
- Traditional RSs suffer from limitations due to correlational reasoning, which can be addressed by using state-of-the-art causal RSs.
- Bias mitigation, explainability promotion, and generalization improvement are important topics that are covered in state-of-the-art causal RSs.

### Causal Debiasing for Recommendations
- RSs inherit biases in observational user behaviors and amplify them in future recommendations
- Exposure bias in RSs broadly refers to the bias in observed ratings due to nonrandomized item exposures
- From the RCM's perspective, exposure bias can be defined as the bias where users are favorably exposed to items depending on their expected ratings for them (i.e., rating potential outcomes)
- Exposure bias occurs due to various reasons, such as users' self-search or the recommendation of the previous RSs
- Since item exposures can be naturally compared with treatments in clinical trials, we discuss the debiasing strategies with the RCM framework
- RSs aim to reweight the biased observed ratings for user-item pairs in the treatment group, i.e., T = {(, ) :    = 1}, to create pseudo randomized samples
- When exposure bias exists, item exposure    depends on the rating potential outcome    (  = 1). Therefore, L Obs is a biased estimator for L True , because the observed ratings for user-item pairs in the treatment group T are biased samples from the rating potential outcomes of the population PO (see Fig. 5).

### Causal Explanation in Recommendations
- Causality is used to explain the user decision process.
- DICE uses the colliding effect of causal graphs to achieve disentanglement, which allows for the separation of user interests and conformity to the trend.

### Causal Generalization of Recommendations
- RSs can be improved with causal intervention and disentanglement
- Causal intervention can improve the generalization of RSs within a dynamic environment
- Causal disentanglement can promote the generalization of RSs by identifying and basing recommendations on causes that are more robust to potential changes in the environments

## Evaluation Strategies for Causal RSs
- Various causal inference techniques are promising to address multiple types of biases
- However, without a well-designed model evaluation strategy, it is difficult to tell whether the proposed causal RS model is indeed effective
- Nor can we guarantee that the model will perform reliably after deploying in a realworld environment
- Evaluation of causal models is particularly difficult, because the groundtruths, i.e., the causal effects of interest, are usually infeasible
- Despite the challenges, there are several strategies that can reliably evaluate causal RSs with biased real-world data

### Evaluation Strategies for Traditional RSs
- Traditional RSs generally follow three steps: First, the observed ratings in the rating matrix R are split into the non-overlapping training set R and test set R, usually by randomly holding out a certain percentage of the observed ratings from each user.
- Then, the proposed RS is trained on ratings in R to learn the latent variables and the associated functional models.
- Finally, the trained RS predicts the missing ratings in R for each user, where the results are compared with the held-out ratings in R to evaluate the model performance.
- The quality of rating predictions can be measured by accuracy-based metrics such as mean squared error (MSE) and mean absolute error (MAE), and ranking-based metrics such as recall, precision, normalized discounted cumulative gain (NDCG), etc.

### Challenges for the Evaluation of Causal RSs
- The evaluation strategy for causal RSs is not directly applicable to causal RSs because ratings in R may have the same spurious correlation and bias as ratings in R
- It is ideal that we have a biased/entangled training set R   to learn the model, and an unbiased/disentangled test set R   for model evaluation, such that the effectiveness of the causal debiasing/disentangling algorithm can be directly verified from experiments. However, such unbiased/disentangled test set R   can be difficult to acquire and expansive to establish.
- Therefore, we first introduce common data simulation strategies for causal RS evaluation. We then discuss how real-world datasets can be directly utilized to further promote the credibility of causal RS research.

### Evaluation Based on Simulated Datasets
- Generative models can be used to simulate exposure bias
- The effectiveness of causal RSs can be easily verified based on the simulated groundtruths

### Evaluation Based on Real-world Datasets
- There are bias-free real-world datasets that can be used for causal RS research.
- The available datasets are compiled into Table 1.
- The Coat dataset is a small-scale dataset that was crowdsourced from the Amazon Mechanical Turkers platform with 300 users and 290 items.
- The Yahoo! R3 dataset is collected from the Yahoo! Music platform.
- The KuaiRec dataset is established based on a popular micro-video sharing platform, KuaiShou, in China (known as Kwai internationally).
- The statistics of the datasets are summarized in Table 1.

## Future Directions
- assumptions required by existing causal RSs could be too strong
- there currently lacks a universal causal model for RSs that can be applied for different causal reasoning purposes
- recent research also found that confounders that spuriously correlate item exposures and user ratings may also help explain the co-occurrence patterns of different items
- how to properly identify and utilize the positive side of biases while maximally suppressing their negative effects is of great importance and deserves more in-depth investigations in the future

## Summary
- Traditional RSs that rely on correlations in observed user behaviors and user/item features have issues with exposure bias.
- Two mainstream causal inference frameworks, i.e., Rubin's RCM and Pearl's SCM, are introduced that provide deeper insights into these issues and the foundation for moving traditional RSs to the upper rungs of the Ladder of Causality.
- State-of-the-art causal RS models that lead to enhanced robustness to various biases and improved explainability are discussed.
- Evaluation strategies for causal RSs are introduced, with an emphasis on how to reliably estimate the model performance based on biased real-world data.
- Finally, real-world datasets where expensive randomized experiments are conducted on users are introduced, which reflects growing attention to causal RSs from the industry.
