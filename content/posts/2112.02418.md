---
title: "YourTTS: Towards Zero-Shot Multi-Speaker TTS and Zero-Shot Voice Conversion for everyone"
date: 2021-12-04T19:50:29.000Z
author: "Edresson Casanova, Julian Weber, Christopher Shulby, Arnaldo Candido Junior, Eren Gölge, Moacir Antonelli Ponti"
weight: 2
showToc: true
TocOpen: true
draft: false
hidemeta: false
comments: false
description: "Important disclaimer: the following content is AI-generated, please make sure to fact check the presented information by reading the full paper."
disableHLJS: true # to disable highlightjs
disableShare: false
hideSummary: false
searchHidden: false
ShowReadingTime: false
ShowBreadCrumbs: false
ShowPostNavLinks: false
ShowWordCount: true
ShowRssButtonInSectionTermList: false
UseHugoToc: false
cover:
    image: "/home/niclas/arxiv-smry/arxiv-smry/static/thumbnails/2112-02418v3.webp" # image path/url
    alt: "YourTTS: Towards Zero-Shot Multi-Speaker TTS and Zero-Shot Voice Conversion for everyone" # alt text
    caption: "The full paper is available [here](https://arxiv.org/abs/2112.02418)." # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: false # only hide on current single page
---

# Link to paper
The full paper is available [here](https://arxiv.org/abs/2112.02418).


# Abstract
- YourTTS brings the power of a multilingual approach to the task of zero-shot
- Our method builds upon the VITS model and adds several novel modifications for zero-shot
- We achieved state-of-the-art (SOTA) results in zero-shot multi-speaker TTS and results comparable
- Additionally, our approach achieves promising results in a target language with
- Finally, it is possible to fine-tune the YourTTS model with less than 1 minute of speech

# Paper Content

## Introduction
- TTS systems have significantly advanced in recent years with deep learning approaches
- Most TTS systems were tailored from a single speaker's voice, but there is current interest in synthesizing voices for new speakers (not seen during training), employing only a few seconds of speech
- Zero-shot multi-speaker TTS (ZS-TTS) using deep learning was first proposed by [5]
- Tacotron 2 [7] was adapted using external speaker embeddings extracted from a trained speaker encoder using a generalized end-to-end loss (GE2E) [8], allowing for speech generation that resembles the target speaker
- Similarly, Tacotron 2 was used with a different speaker embeddings methods [2], with LDE embeddings [9] to improve similarity and naturalness of speech for unseen speakers
- The authors also showed that a gender-dependent model improves the similarity for unseen speakers [2]
- In this context, Attentron [3] proposed a finegrained encoder with an attention mechanism for extracting detailed styles from various reference samples and a coarsegrained encoder
- As a result of using several reference samples, they achieved better voice similarity for unseen speakers
- ZSM-SS [11] is a Transformer-based architecture with a normalization architecture and an external speaker encoder based on Wav2vec 2.0 [12]
- The authors conditioned the normalization architecture with speaker embeddings, pitch, and energy
- Despite promising results, the authors did not compare the proposed model with any of the related works mentioned above
- SC-GlowTTS [4] was the first application of flow-based models in ZS-TTS
- It improved voice similarity for unseen speakers in training with respect to previous studies while maintaining comparable quality
- Despite these advances, the similarity gap between observed and unobserved speakers during training is still an open research question
- ZS-TTS models still require a considerable amount of speakers for training, making it difficult to obtain high-quality models in low-resource languages
- Furthermore, according to [13], the quality of current ZS-TTS models is not sufficiently good, especially for target speakers with speech characteristics that differ from those seen in training
- When one limits the number and variety of training speakers, it also further hinders the model generalization for unseen voices
- In parallel with the ZS-TTS, multilingual TTS has also evolved aiming at learning models for multiple languages at the same time
- Some of these models are particularly interesting as they allow for code-switching, i.e. changing the target language for some part of a sentence, while keeping the same voice
- Our novel zero-shot multi-speaker TTS approach includes the following contributions:
- State-of-the-art results in the English Language
- The first work proposing a multilingual approach in the zero-shot multi-speaker TTS scope
- Ability to do zero-shot multi-speaker TTS and zero-shot Voice Conversion with promising quality and similarity in a target language using only one speaker in the target language during model training
- Require less than 1 minute of speech to fine-tune the model for speakers who have voice/recording characteristics very different from those seen in model training, and still achieve good similarity and quality results.

## YourTTS Model
- YourTTS uses raw text as input instead of phonemes
- YourTTS includes a transformer-based text encoder, 10 transformer blocks, and 196 hidden channels
- YourTTS uses a stack of 4 affine coupling layers to match the dimensions of the input text
- YourTTS uses a variational autoencoder to generate human-like rhythms of speech

## Experiments

### Speaker Encoder
- The speaker encoder used in the SC-GlowTTS paper [4] reached an EER of 5.244.
- The H/ASP model [29] publicly available, that was trained with the Prototypical Angular [30] plus Softmax loss functions in the VoxCeleb 2 [31] dataset was chosen for achieving state-of-the-art results in Vox-Celeb 1 [32] test subset.
- In addition, we evaluated the model in the test subset of Multilingual LibriSpeech (MLS) [33] using all languages. This model reached an average Equal Error Rate (EER) of 1.967 while the speaker encoder used in the SC-GlowTTS paper [4] reached an EER of 5.244.

### Audio datasets
- The VCTK dataset contains 44 hours of speech and 109 speakers
- The TTS-Portuguese Corpus contains 10 hours of speech
- The fr FR set of the M-AILABS dataset contains 2 female (104h) and 3 male speakers (71h) sampled at 16KHz
- To evaluate the zero-shot multi-speaker capabilities of our model in English, we use the 11 VCTK speakers reserved for testing
- To further test its performance outside of the VCTK domain, we select 10 speakers (5F/5M) from subset test-clean of LibriTTS dataset
- For Portuguese we select samples 6 from 10 speakers (5F/5M) from the Multilingual LibriSpeech (MLS) dataset
- For French, no evaluation dataset was used, due to the reasons described in Section 4

### Experimental setup
- The four experiments were done with different datasets and different methods
- The experiments used a TTS model trained on the VCTK dataset
- The experiments used a different method to train the TTS model for each language
- The experiments used a different method to train the TTS model for each language and a different optimizer

## Results and Discussion
- Mean Opinion Score (MOS)
- Speaker Encoder Cosine Similarity (SECS)
- Similarity MOS (Sim-MOS)
- Ground Truth
- 95% Confidence Intervals
- Evaluates synthesized speech quality using a Mean Opinion Score (MOS) study
- To compare the similarity between the synthesized voice and the original speaker, calculates the Speaker Encoder Cosine Similarity (SECS)
- Uses the speaker encoder of the Resemblyzer [43] package
- Reports the Similarity MOS (Sim-MOS) following the works of [1], [3], and [4]
- Uses the translation of these 55 sentences during inference
- Uses 5 sentences per speaker in order to ensure coverage of all speakers and a good number of sentences as ground truth

### VCTK dataset
- The best similarity results were obtained with experiments 1 (monolingual) and 2 + SCL (bilingual).
- According to the Sim-MOS, the use of SCL did not bring any improvements; however, the confidence intervals of all experiments overlap, making this analysis inconclusive.
- On the other hand, according to SECS, using SCL improved the similarity in 2 out of 3 experiments.
- Also, for experiment 2, both metrics agree on the positive effect of SCL in similarity.
- Another noteworthy result is that SECS for all of our experiments on the VCTK dataset are higher than the ground truth. This can be explained by characteristics of the VCTK dataset itself which has, for example, significant breathing sounds in most audios.
- The speaker encoder may not be able to handle these features, hereby lowering the SECS of the ground truth.
- Overall, in our best experiments with VCTK, the similarity (SECS and Sim-MOS) and quality (MOS) results are similar to the ground truth.

### LibriTTS dataset
- We achieved the best LibriTTS similarity in experiment 4.
- This result can be explained by the use of more speakers (∼ 1.2k) than any other experiments.
- On the other hand, MOS achieved the best result for the monolingual case.
- We believe that this was mainly due to the quality of the training datasets.

### Portuguese MLS dataset
- The Portuguese MLS dataset had the highest MOS metric
- The model trained in Portuguese with a single-speaker dataset of medium quality, managed to reach a good quality in the zero-shot multi-speaker synthesis
- Experiment 3 is the best experiment according to Sim-MOS (3.19±0.10) however, with an overlap with other ones considering the confidence intervals
- In this dataset, Sim-MOS and SECS do not agree: based on the SECS metric, the model with higher similarity was obtained in experiment 4+SCL
- We believe this is due to the variety in the LibriTTS dataset
- The dataset is also composed of audiobooks, therefore tending to have similar recording characteristics and prosody to the MLS dataset
- Sim-MOS achieved in this dataset is relevant, considering that our model was trained with only one male speaker in
- Analyzing the metrics by gender, the MOS for experiment 4 considering only male and female speakers are respectively 4.14 ± 0.11 and 3.79 ± 0.12. Also, the Sim-MOS for male and female speakers are respectively 3.29 ± 0.14 and 2.84 ± 0.14. Therefore, the performance of our model in Portuguese is affected by gender.
- When French is added, then only a third of the batch will be composed of the Portuguese speaker voice

### Speaker Consistency Loss
- The use of Speaker Consistency Loss (SCL) improved similarity measured by SECS.
- On the other hand, for the Sim-MOS the confidence intervals between the experiments are inconclusive to assert that the SCL improves similarity.
- Nevertheless, we believe that SCL can help the generalization in recording characteristics not seen in training.
- For example, in experiment 1, the model did not see the recording characteristics of the Lib-riTTS dataset in training but during testing on this dataset, both the SECS and Sim-MOS metrics showed an improvement in similarity thanks to SCL.
- On the other hand, it seems that using SCL slightly decreases the quality of generated audio.
- We believe this is because with the use of SCL, our model learns to generate recording characteristics present in the reference audio, producing more distortion and noise.
- However, it should be noted that in our tests with high-quality reference samples, the model is able to generate high-quality speech.

## Zero-Shot Voice Conversion
- As in the SC-GlowTTS model, we do not provide any information about the speaker's identity to the encoder, so the distribution predicted by the encoder is forced to be speaker independent.
- Therefore, YourTTS can convert voices using the model's Posterior Encoder, decoder and the HiFi-GAN Generator.
- Since we conditioned YourTTS with external speaker embeddings, it enables our model to mimic the voice of unseen speakers in a zero-shot voice conversion setting.
- In [44], the authors reported the MOS and Sim-MOS metrics for the AutoVC [45] and NoiseVC [44] models for 10 VCTK speakers not seen during training.
- To compare our results, we selected 8 speakers (4M/4F) from the VCTK test subset.
- Although [44] uses 10 speakers, due to gender balance, we were forced to use only 8 speakers.
- Furthermore, to analyze the generalization of the model for the Portuguese language, and to verify the result achieved by our model in a language where the model was trained with only one speaker, we used the 8 speakers (4M/4F) from the test subset of the MLS Portuguese dataset.

### Intra-lingual results
- For zero-shot voice conversion from one English-speaker to another English-speaker, the model achieved a MOS of 4.20±0.05
- For zero-shot voice conversion from one Portuguese speaker to another Portuguese speaker, the model achieved a MOS of 3.64±0.09
- For voice transfer similarity between female speakers, the model achieved a MOS of 3.35±0.19, compared to transfers between male speakers, who achieved a MOS of 3.80±0.15

### Cross-lingual results
- Apparently, the transfer between English and Portuguese speakers works as well as the transfer between Portuguese speakers.
- However, for the transfer of a Portuguese speaker to an English speaker (pt-en) the MOS scores drop in quality.
- This was especially due to the low quality of voice conversion from Portuguese male speakers to English female speakers.
- In general, as discussed above, due to the lack of female speakers in the training of the model, the transfer to female speakers achieves poor results.
- In this case, the challenge is even greater as it is necessary to convert audios from a male speaker in Portuguese to the voice of a English female speaker.
- However, for transfers involving Portuguese, the absence of female voices in the training of the model hindered generalization.

## Speaker Adaptation
- The different recording conditions are a challenge for the generalization of the zero-shot multi-speaker TTS models.
- Speakers who have a voice that differs greatly from those seen in training also become a challenge [13].
- Nevertheless, to show the potential of our model for adaptation to new speakers/recording conditions, we selected samples from 20 to 61 seconds of speech for 2 Portuguese and 2 English speakers (1M/1F) in the Common Voice [38] dataset.
- Using these 4 speakers, we perform fine-tuning on the checkpoint from experiment 4 with Speaker Consistency Loss individually for each speaker.
- During fine-tuning, to ensure that multilingual synthesis is not impaired, we use all the datasets used in experiment 4.
- However, we use Weighted random sampling [41] to guarantee that samples from adapted speakers appear in a quarter of the batch.
- The model is trained that way for 1500 steps.
- For evaluation, we use the same approach described in Section 4.
- Table 3 shows the gender, total duration in seconds and number of samples used during the training for each speaker, and the metrics SECS, MOS and Sim-MOS for the ground truth (GT), zero-shot multi-speaker TTS mode (ZS), and the finetuning (FT) with speaker samples.
- In general, our model's fine-tuning with less than 1 minute of speech from speakers who have recording characteristics not seen during training achieved very promising results, significantly improving similarity in all experiments.
- In English, the results of our model in zero-shot multispeaker TTS mode are already good and after fine-tuning both male and female speakers achieved Sim-MOS comparable to the ground truth.
- The fine-tuned model achieves greater SECS than the ground truth, which was already observed in previous experiments.
- We believe that this phenomenon can be explained by the model learning to copy the recording characteristics and reference sample's distortions, giving an advantage over other real speaker samples.
- In Portuguese, compared to zero-shot, fine-tuning seems to trade a bit of naturalness for a much better similarity.
- For the male speaker, the Sim-MOS increased from 3.35±0.12 to 4.19±0.07 after fine-tuning with just 31 seconds of speech for that speaker.
- For the female speaker, the similarity improvement was even more impressive, going from 2.77±0.15 in zeroshot mode to 4.43±0.06 after the fine-tuning with just 20 seconds of speech from that speaker.
- Although our model manages to achieve high similarity using only seconds of the target speaker's speech, Table 3 seems to presents a direct relationship between the amount of speech used and the naturalness of speech (MOS).
- With approximately 1 minute of speech in the speaker's voice our model can copy the speaker's speech characteristics, even increasing the naturalness compared to zero-shot mode.
- However, using 44 seconds or less of speech reduces the quality/naturalness of the generated speech when compared to the zero-shot or ground truth model. Therefore, although our model shows good results in copying the speaker's speech characteristics using only 20 seconds of speech, more than 45 seconds of speech are more adequate to allow higher quality.
- Finally, we also noticed that voice conversion improves significantly after fine-tuning the model, mainly in Portuguese and French where few speakers are used in training.

## Conclusions, limitations and future work
- YourTTS achieved SOTA results in zero-shot multi-speaker TTS and zero-shot voice conversion in the VCTK dataset
- The model can achieve promising results in a target language using only a single speaker dataset
- For speakers who have both a voice and recording conditions that differ greatly from those seen in training, our model can be adjusted to a new voice using less than 1 minute of speech
- However, our model exhibits some limitations, most notably instability in the stochastic duration predictor which, for some speakers and sentences, generates unnatural durations
- Mispronunciations occur for some words, especially in Portuguese

## Acknowledgements
- The study was financed in part by the Coordenac ¸ão de Aperfeic ¸oamento de Pessoal de Nível Superior -Brasil (CAPES) -Finance Code 001, as well as CNPq (National Council of Technological and Scientific Development) grants 304266/2020-5.
- In addition, this research was financed in part by Artificial Intelligence Excellence Center (CEIA) 10 via projects funded by the Department of Higher Education of the Ministry of Education (SESU/MEC) and Cyberlabs Group 11 .
- Also, we would like to thank the Defined.ai 12 for making industrial-level MOS testing so easily available.
- Finally, we would like to thank all contributors to the Coqui TTS reposi- Figure 1: YourTTS diagram depicting (a) training procedure and (b) inference procedure.
- The study was financed in part by the Coordenac ¸ão de Aperfeic ¸oamento de Pessoal de Nível Superior -Brasil (CAPES) -Finance Code 001, as well as CNPq (National Council of Technological and Scientific Development) grants 304266/2020-5.
- In addition, this research was financed in part by Artificial Intelligence Excellence Center (CEIA) 10 via projects funded by the Department of Higher Education of the Ministry of Education (SESU/MEC) and Cyberlabs Group 11 .
- Also, we would like to thank the Defined.ai 12 for making industrial-level MOS testing so easily available.
- Finally, we would like to thank all contributors to the Coqui TTS reposi- Figure 1: YourTTS diagram depicting (a) training procedure and (b) inference procedure.
